<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- External Libraries -->
        <script src="https://d3js.org/d3.v5.js"></script>
        <!-- CSS -->
        <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    </head>
    <body>
        <div class="row">
            <div class="column">
                <div class="card">
                    <div id="revenue"></div>
                    <div class="row">
                        <div class="column">
                            <div id="tablet-title-revenue">Tablet</div>
                            <div class="legend" id="tablet-legend-revenue"></div>
                        </div>
                        <div class="column right">
                            <div id="smartphone-title-revenue">Smartphone</div>
                            <div class="legend" id="smartphone-legend-revenue"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="column">
                <div class="card">
                    <!-- <h><b>John Doe</b></h4>
                    <p>Architect & Engineer</p> -->
                    <div id="impressions"></div>
                </div>
            </div>
            <div class="column">
                <div class="card">
                    <!-- <h><b>John Doe</b></h4>
                    <p>Architect & Engineer</p> -->
                    <div id="visits"></div>
                </div>
            </div>
        </div>
    </body>
</html>
<!-- Internal Dependencies -->
<script src="models/data.js"></script>
<script src="components/donut.js"></script>
<script>
    // var ids = document.querySelectorAll('*[id]');
    var allElements = document.getElementsByTagName('*');
    var ids = [];
    var render = (ids) => {
        for (let i=0; i<ids.length; i++) {
            var item = ids[i]
            document.getElementById(item.tabletTitle).style.color = item.tabletColor
            document.getElementById(item.smartphoneTitle).style.color = item.smartphoneColor
        }
    } 
    for (let i = 0, n = allElements.length; i < n; ++i) {
        var el = allElements[i];
        // console.log('element', el)
        let idObj = {}
        if (el.id && (el.id.includes('revenue') || el.id.includes('impressions') || el.id.includes('visits'))) {
            if (['revenue', 'impressions', 'visits'].indexOf(el.id) > -1) {
                idObj = {
                    id: el.id,
                    colors: data(el.id).colors,
                    tabletTitle: 'tablet-title-'+el.id,
                    smartphoneTitle: 'smartphone-title-'+el.id,
                    tabletLegend: 'tablet-legend-'+el.id,
                    smartphoneLegend: 'smartphone-legend-'+el.id,
                    tabletColor: data(el.id).colors[0],
                    smartphoneColor: data(el.id).colors[1],
                    value1: data(el.id).values[0].value,
                    value2: data(el.id).values[1].value,
                    percentage1: Math.round((data(el.id).values[0].value/data(el.id).total)*100)+'%',
                    percentage2: Math.round((data(el.id).values[1].value/data(el.id).total)*100)+'%'
                }
            }
            if (idObj.id) {

            }
            ids.push({
                id: el.id,
                colors: data(el.id).colors,
                tabletTitle: 'tablet-title-'+el.id,
                smartphoneTitle: 'smartphone-title-'+el.id,
                tabletLegend: 'tablet-legend-'+el.id,
                smartphoneLegend: 'smartphone-legend-'+el.id,
                tabletColor: data(el.id).colors[0],
                smartphoneColor: data(el.id).colors[1],
                value1: data(el.id).values[0].value,
                value2: data(el.id).values[1].value,
                percentage1: Math.round((data(el.id).values[0].value/data(el.id).total)*100)+'%',
                percentage2: Math.round((data(el.id).values[1].value/data(el.id).total)*100)+'%'
            });
        }
        
        /* if (el.id && el.id.includes('tablet-title') && el.id.includes(currentId)) {
            console.log('logging id', el.id)
            console.log('contains?', el.id.includes('tablet-title') && el.id.includes(currentId))
            document.getElementById(el.id).style.color = colors[0]
        } */
        /* if (el.id.includes('tablet-title') && el.id.includes(currentId)) {
            document.getElementById(el.id).style.color = colors[0]
        }
        if (el.id.includes('smartphone-title') && el.id.includes(currentId)) {
            document.getElementById(el.id).style.color = colors[1]
        } */
        
    }
    console.log('ids', ids);
    /* document.addEventListener('DOMContentLoaded', () => {
        alert('DOM ready to go!')
        setTimeout(() => {
            render(ids)
        }, 1000)
    }) */
    window.onload = () => {
        for (let i=0; i<ids.length; i++) {
            var item = ids[i]
            console.log(document.getElementById(item.tabletTitle).innerHTML)
            renderDonut(item.id)
        }

            
            // document.getElementById(item.tabletTitle).style.color = item.tabletColor
            // document.getElementById(item.smartphoneTitle).style.color = item.smartphoneColor
    }
    

    /* ids.map(id => {
        document.getElementById(id.tabletTitle).style.color = id.tabletColor

    }) */
    /* document.getElementById('tablet-title-'+id).style.color = data(id).colors[0]
    document.getElementById('smartphone-title-'+id).style.color = data(id).colors[1] */
    /* allIds.map(id => {
        var oMaster = document.getElementById(id), oChild;
        for(i = 0; i < oMaster.childNodes.length; i++) {
            console.log('childnodes', oMaster.childNodes)
            oChild = oMaster.childNodes[i];
            if(oChild.nodeName == 'INPUT') {
                alert(oChild.id);
            }
        } */
        /* var tabletLegend = document.getElementById('tablet-legend-'+id)
        var smartphoneLegend = document.getElementById('smartphone-legend-'+id)
        data(id).values.map((item, i) => {
            console.log(Math.round((item.value/data(id).total)*100))
            if (i === 0) {
                tabletLegend.textContent = Math.round((item.value/data(id).total)*100)+'%'
            }
            if (i === 1) {
                smartphoneLegend.textContent = Math.round((item.value/data(id).total)*100)+'%'
            }
        }) */
        
        
    // });


</script>
